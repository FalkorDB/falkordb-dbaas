# Observability Stack - Application plane

Defines the resources that will be deployed in each application cluster to monitor its contents.

The application plane for the observability stack is composed of the following components:

- Prometheus: Store metrics
  - Alertmanager
- Grafana Alloy: Scrape metrics from applications, and write them to the control plane
- Pod Monitor: Scrape metrics from pods
- VPC Peering connection to the control plane: allow streaming metrics from the application plane to the control plane
-

## Adding clusters to be monitored

Steps:

1. Create the node pool for the desired cluster

```bash
gcloud container node-pools create observability \
    --cluster=<cluster-name> \
    --region=<region> \
    --machine-type=e2-standard-2 \
    --num-nodes=1 \
    --enable-autoscaling \
    --min-nodes=1 \
    --max-nodes=3 \
    --project=<project-id> \
```

2. Add the cluster credentials to the observability cluster in the control plane

```bash
argocd cluster add <context> --server <server>
```
